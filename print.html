<!DOCTYPE HTML>
<html lang="en" class="ayu sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Shunt</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="Documentation for Shunt">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/css/style.css">
        <link rel="stylesheet" href="theme/css/mermaid.css">
        <link rel="stylesheet" href="theme/highlight.js">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "ayu";
            const default_dark_theme = "ayu";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Shunt</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/TheSignPainter98/shunt" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Shunt is a railway network controller for Minecraft for transporting resources on <a href="https://github.com/Creators-of-Create/Create">Create mod</a> trains between factories.</p>
<p>Shunt listens for the current state of factories in a world, learning about the resources they hold and the amounts they need.
When it detects that a factory, <em>A,</em> has a shortage of some resource and that a factory, <em>B,</em> has a surplus of that resource, it arranges a train to deliver from <em>B</em> to <em>A.</em>
All that’s required is to make sure there’s a computer running <code>shunt</code> at each factory single Shunt marshal can handle the rest.</p>
<p>As Shunt will take control of train-scheduling, there is no longer a need to create a brand new train dedicated to transporting small amounts of a single resource between two factories.
Instead, Shunt will consider all trains as part of a central pool and route them to where they’re needed, when they’re needed.
As such, the number of trains required to run a factory network is <em>significantly</em> reduced.</p>
<!-- To get started, [install shunt on a floppy disk](./how-to/install.md) and then follow the [let’s go shunt](./tutorials/lets-go-shunt.md). -->
<p>The rest of these docs is organised as follows:</p>
<span>
    <div class="quote-grid">
        <blockquote>
            <p>
                <div class="diataxis-card-header">
                    <a href="./tutorials/index.html">Tutorials</a>
                </div>
                Hands-on lessons in using shunt
            </p>
        </blockquote>
        <blockquote>
            <p>
                <div class="diataxis-card-header">
                    <a href="./how-to/index.html">How-to guides</a>
                </div>
                Step-by-step instructions for common tasks
            </p>
        </blockquote>
        <blockquote>
            <p>
                <div class="diataxis-card-header">
                    <a href="./explanations/index.html">Explanation</a>
                </div>
                Long-form discussion of key topics
            </p>
        </blockquote>
        <blockquote>
            <p>
                <div class="diataxis-card-header">
                    <a href="./reference-materials/index.html">Reference materials</a>
                </div>
                Technical information about shunt
            </p>
        </blockquote>
    </div>
</span>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tutorials"><a class="header" href="#tutorials">Tutorials</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-guides"><a class="header" href="#how-to-guides">How-to guides</a></h1>
<ul>
<li><a href="how-to/how-to-install-shunt.html">How to install shunt</a></li>
<li><a href="how-to/how-to-create-an-installer-disk.html">How to create an installer disk</a></li>
<li><a href="how-to/how-to-use-an-installer-disk.html">How to use an installer disk</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-install-shunt"><a class="header" href="#how-to-install-shunt">How to install <code>shunt</code></a></h1>
<!-- TODO(kcza): release in the docs site to be shown at kcza.net/shunt/shunt -->
<p><strong>NOTE</strong>: If you already have a working Shunt marshal and wish to create more nodes, read <a href="how-to/./how-to-create-an-installer-disk.html">how to create an installer disk</a>.</p>
<h2 id="you-will-need"><a class="header" href="#you-will-need">You will need</a></h2>
<ul>
<li>A computercraft computer</li>
<li>An internet connection</li>
</ul>
<h2 id="complete-the-following-steps"><a class="header" href="#complete-the-following-steps">Complete the following steps</a></h2>
<ol>
<li>
<p>Open the computer.</p>
</li>
<li>
<p>If there are any programs running, terminate them by holding <code>Ctrl+T</code>.</p>
</li>
<li>
<p>If the shell is not in the root directory (i.e. the prompt looks like <code>some/path&gt;</code>), type and run—</p>
<pre><code class="language-bash">cd /
</code></pre>
</li>
<li>
<p>Type and run the following command—</p>
<pre><code class="language-bash">wget https://kcza.net/shunt/shunt
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-create-an-installer-disk"><a class="header" href="#how-to-create-an-installer-disk">How to create an installer disk</a></h1>
<h2 id="you-will-need-1"><a class="header" href="#you-will-need-1">You will need</a></h2>
<ul>
<li>A computercraft computer with <code>shunt</code> installed (<a href="how-to/./how-to-install-shunt.html">how to install <code>shunt</code></a>)</li>
<li>A disk drive</li>
<li>A floppy disk</li>
</ul>
<h2 id="complete-the-following-steps-1"><a class="header" href="#complete-the-following-steps-1">Complete the following steps</a></h2>
<ol>
<li>Place the disk drive directly adjacent to the computer</li>
<li>Insert the disk into the disk drive</li>
<li>Type and run the following command—
<pre><code class="language-bash">shunt flash
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-to-use-an-installer-disk"><a class="header" href="#how-to-use-an-installer-disk">How to use an installer disk</a></h1>
<h2 id="you-will-need-2"><a class="header" href="#you-will-need-2">You will need</a></h2>
<ul>
<li>A computercraft computer</li>
<li>A disk drive</li>
<li>An installer disk (<a href="how-to/./how-to-create-an-installer-disk.html">how to create one</a>)</li>
</ul>
<h2 id="complete-the-following-steps-2"><a class="header" href="#complete-the-following-steps-2">Complete the following steps</a></h2>
<ol>
<li>Switch off the computer</li>
<li>Place the drive directly adjacent to the computer</li>
<li>Insert the disk into the disk drive</li>
<li>Open the computer</li>
<li>Follow the instructions on screen.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reference-materials"><a class="header" href="#reference-materials">Reference materials</a></h1>
<ul>
<li><a href="reference-materials/data-flow.html">Data flow</a></li>
<li><a href="reference-materials/marshal-state-machines.html">Marshal state machines</a></li>
<li><a href="reference-materials/public-protocols.html">Public protocols</a></li>
<li><a href="reference-materials/quicktype-notation/index.html">Quicktype notation</a></li>
<li><a href="reference-materials/types.html">Types</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-flow"><a class="header" href="#data-flow">Data flow</a></h1>
<p>This page is partitioned into information flow and request flow.</p>
<h2 id="information-flow"><a class="header" href="#information-flow">Information flow</a></h2>
<p>System state:</p>
<pre><code class="language-mermaid">stateDiagram
    train_1_1: train
    train_1_1 --&gt; station_1_1
    train_1_n: train
    train_1_n --&gt; station_1_n

    station_1_1: station
    station_1_1 --&gt; factory_1
    station_1_ddd: ...
    station_1_ddd --&gt; factory_1
    station_1_n: station
    station_1_n --&gt; factory_1

    factory_1: factory
    factory_1 --&gt; marshal

    factory_ddd: ...
    factory_ddd --&gt; marshal

    train_m_1: train
    train_m_1 --&gt; station_m_1
    train_m_n: train
    train_m_n --&gt; station_m_n

    station_m_1: station
    station_m_1 --&gt; factory_m
    station_m_ddd: ...
    station_m_ddd --&gt; factory_m
    station_m_n: station
    station_m_n --&gt; factory_m

    factory_m: factory
    factory_m --&gt; marshal

    state marshal {
        leader
        leader --&gt; follower_1
        leader --&gt; follower_ddd
        leader --&gt; follower_n
        follower_1: follower
        follower_ddd: ...
        follower_n: follower
    }
    marshal --&gt; display_1
    display_1: display
    marshal --&gt; display_ddd
    display_ddd: ...
    marshal --&gt; display_n
    display_n: display
</code></pre>
<h2 id="request-flow"><a class="header" href="#request-flow">Request flow</a></h2>
<p>Train schedule requests:</p>
<pre><code class="language-mermaid">stateDiagram
    marshal --&gt; factory: request apply schedule
    factory --&gt; station: apply schedule
    station --&gt; train: schedule
</code></pre>
<p>Config application requests:</p>
<pre><code class="language-mermaid">stateDiagram
    configurator --&gt; marshal: new config
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="marshal-state-machines"><a class="header" href="#marshal-state-machines">Marshal state machines</a></h1>
<h2 id="marshal"><a class="header" href="#marshal"><code>marshal</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; waiting
  analysing_declare_train_state
  analysing_declare_train_state --&gt; enqueueing_declare_train_state
  analysing_marshal_identity_request
  analysing_marshal_identity_request --&gt; sending_marshal_identity_response
  applying_config
  applying_config --&gt; waiting
  changing_epoch
  changing_epoch --&gt; waiting
  enqueueing_declare_train_state
  enqueueing_declare_train_state --&gt; sending_declare_train_state_response
  inspecting_packet
  inspecting_packet --&gt; analysing_declare_train_state
  inspecting_packet --&gt; analysing_marshal_identity_request
  inspecting_packet --&gt; waiting
  sending_declare_train_state_response
  sending_declare_train_state_response --&gt; waiting
  sending_marshal_identity_response
  sending_marshal_identity_response --&gt; waiting
  waiting
  waiting --&gt; applying_config
  waiting --&gt; changing_epoch
  waiting --&gt; inspecting_packet
</code></pre>
<p>The states of <code>marshal</code> contain the following data:</p>
<ul>
<li>analysing_declare_train_state:
<pre><code class="language-moonscript">packet: DeclareTrainState,
</code></pre>
</li>
<li>analysing_marshal_identity_request:
<pre><code class="language-moonscript">packet: MarshalIdentityRequest,
</code></pre>
</li>
<li>applying_config:
<pre><code class="language-moonscript">config: MarshalConfig,
</code></pre>
</li>
<li>changing_epoch:
<pre><code class="language-moonscript">new_epoch: number,
</code></pre>
</li>
<li>enqueueing_declare_train_state:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
pc_id: number,
train_name: string,
state: TrainState,
</code></pre>
</li>
<li>inspecting_packet:
<pre><code class="language-moonscript">packet: Packet,
</code></pre>
</li>
<li>sending_declare_train_state_response:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
recipient_id: number,
error_reason: ?string
</code></pre>
</li>
<li>sending_marshal_identity_response:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
recipient_id: number,
resp: number|string,
</code></pre>
</li>
<li>waiting:
<em>none</em></li>
</ul>
<h2 id="resource_orchestrator"><a class="header" href="#resource_orchestrator"><code>resource_orchestrator</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; waiting
  analysing_factory_heartbeat
  analysing_factory_heartbeat --&gt; managing_resources
  analysing_factory_heartbeat --&gt; waiting
  analysing_schedule_response
  analysing_schedule_response --&gt; schedule_applied
  analysing_schedule_response --&gt; schedule_not_applied
  applying_config
  applying_config --&gt; waiting
  awaiting_schedule_response
  awaiting_schedule_response --&gt; analysing_schedule_response
  awaiting_schedule_response --&gt; schedule_not_applied
  changing_epoch
  changing_epoch --&gt; waiting
  generating_schedule
  generating_schedule --&gt; managing_resources
  generating_schedule --&gt; sending_schedule
  inspecting_packet
  inspecting_packet --&gt; analysing_factory_heartbeat
  inspecting_packet --&gt; waiting
  managing_resource
  managing_resource --&gt; generating_schedule
  managing_resources
  managing_resources --&gt; managing_resource
  managing_resources --&gt; waiting
  schedule_applied
  schedule_applied --&gt; managing_resources
  schedule_not_applied
  schedule_not_applied --&gt; generating_schedule
  schedule_not_applied --&gt; managing_resources
  sending_schedule
  sending_schedule --&gt; awaiting_schedule_response
  waiting
  waiting --&gt; applying_config
  waiting --&gt; changing_epoch
  waiting --&gt; inspecting_packet
</code></pre>
<p>The states of <code>resource_orchestrator</code> contain the following data:</p>
<ul>
<li>analysing_factory_heartbeat:
<pre><code class="language-moonscript">packet: FactoryHeartbeat,
</code></pre>
</li>
<li>analysing_schedule_response:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
schedule_generator: ScheduleGenerator,
attempt: number,
packet: ScheduleResponse,
</code></pre>
</li>
<li>applying_config:
<pre><code class="language-moonscript">config: MarshalConfig
</code></pre>
</li>
<li>awaiting_schedule_response:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
schedule_generator: ScheduleGenerator,
attempt: number,
idemp_tok: IdempotenceToken,
deadline: number,
</code></pre>
</li>
<li>changing_epoch:
<pre><code class="language-moonscript">new_epoch: number,
</code></pre>
</li>
<li>generating_schedule:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
schedule_generator: ScheduleGenerator,
attempt: number,
</code></pre>
</li>
<li>inspecting_packet:
<pre><code class="language-moonscript">packet: Packet
</code></pre>
</li>
<li>managing_resource:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
</code></pre>
</li>
<li>managing_resources:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
</code></pre>
</li>
<li>schedule_applied:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
</code></pre>
</li>
<li>schedule_not_applied:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
schedule_generator: ScheduleGenerator,
attempt: number,
cause: string,
</code></pre>
</li>
<li>sending_schedule:
<pre><code class="language-moonscript">factory: Factory,
low_resources: Queue,
low_resource: string,
schedule_generator: ScheduleGenerator,
attempt: number,
candidate: ScheduleCandidate,
</code></pre>
</li>
<li>waiting:
<em>none</em></li>
</ul>
<h2 id="scheduler"><a class="header" href="#scheduler"><code>scheduler</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; waiting
  analysing_factory_heartbeat
  analysing_factory_heartbeat --&gt; waiting
  enacting_train_state_declaration
  enacting_train_state_declaration --&gt; waiting
  inspecting_packet
  inspecting_packet --&gt; analysing_factory_heartbeat
  scheduling
  scheduling --&gt; waiting
  waiting
  waiting --&gt; enacting_train_state_declaration
  waiting --&gt; inspecting_packet
  waiting --&gt; scheduling
</code></pre>
<p>The states of <code>scheduler</code> contain the following data:</p>
<ul>
<li>analysing_factory_heartbeat:
<pre><code class="language-moonscript">packet: FactoryHeartbeat,
</code></pre>
</li>
<li>enacting_train_state_declaration:
<pre><code class="language-moonscript">train_name: string,
state: TrainState,
</code></pre>
</li>
<li>inspecting_packet:
<pre><code class="language-moonscript">packet: Packet,
</code></pre>
</li>
<li>scheduling:
<pre><code class="language-moonscript">schedule_generator: ScheduleGenerator,
</code></pre>
</li>
<li>waiting:
<em>none</em></li>
</ul>
<h2 id="schedule_generator"><a class="header" href="#schedule_generator"><code>schedule_generator</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; generating_schedules
  generating_schedules
  generating_schedules --&gt; out_of_schedules
  generating_schedules --&gt; proposing_schedule
  out_of_schedules
  out_of_schedules --&gt; [*]
  proposing_schedule
  proposing_schedule --&gt; [*]
  proposing_schedule --&gt; generating_schedules
  proposing_schedule --&gt; proposing_schedule
</code></pre>
<p>The states of <code>schedule_generator</code> contain the following data:</p>
<ul>
<li>generating_schedules:
<em>none</em></li>
<li>out_of_schedules:
<em>none</em></li>
<li>proposing_schedule:
<pre><code class="language-moonscript">schedule: ScheduleCandidate,
schedules: Queue,
promise: Promise,
</code></pre>
</li>
</ul>
<h2 id="schedule_generator_impl"><a class="header" href="#schedule_generator_impl"><code>schedule_generator_impl</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; generating_inbound_local_schedules
  generating_global_schedules
  generating_global_schedules --&gt; out_of_schedules
  generating_global_schedules --&gt; proposing_global_schedules
  generating_inbound_local_schedules
  generating_inbound_local_schedules --&gt; generating_outbound_local_schedules
  generating_inbound_local_schedules --&gt; proposing_inbound_local_schedules
  generating_outbound_local_schedules
  generating_outbound_local_schedules --&gt; generating_global_schedules
  generating_outbound_local_schedules --&gt; proposing_outbound_local_schedules
  out_of_schedules
  out_of_schedules --&gt; [*]
  proposing_global_schedules
  proposing_global_schedules --&gt; [*]
  proposing_global_schedules --&gt; out_of_schedules
  proposing_inbound_local_schedules
  proposing_inbound_local_schedules --&gt; [*]
  proposing_inbound_local_schedules --&gt; generating_outbound_local_schedules
  proposing_outbound_local_schedules
  proposing_outbound_local_schedules --&gt; [*]
  proposing_outbound_local_schedules --&gt; generating_global_schedules
</code></pre>
<p>The states of <code>schedule_generator_impl</code> contain the following data:</p>
<ul>
<li>generating_global_schedules:
<em>none</em></li>
<li>generating_inbound_local_schedules:
<em>none</em></li>
<li>generating_outbound_local_schedules:
<em>none</em></li>
<li>out_of_schedules:
<em>none</em></li>
<li>proposing_global_schedules:
<pre><code class="language-moonscript">schedules: [ScheduleCandidate],
</code></pre>
</li>
<li>proposing_inbound_local_schedules:
<pre><code class="language-moonscript">schedules: [ScheduleCandidate],
</code></pre>
</li>
<li>proposing_outbound_local_schedules:
<pre><code class="language-moonscript">schedules: [ScheduleCandidate],
</code></pre>
</li>
</ul>
<h2 id="upgrade_listener"><a class="header" href="#upgrade_listener"><code>upgrade_listener</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; waiting
  analysing_current_release_request
  analysing_current_release_request --&gt; sending_current_release_response
  analysing_reboot_request
  analysing_reboot_request --&gt; rebooting
  analysing_update
  analysing_update --&gt; testing_update
  applying_update
  applying_update --&gt; broadcasting_reboot
  broadcasting_reboot
  broadcasting_reboot --&gt; rebooting
  inspecting_packet
  inspecting_packet --&gt; analysing_current_release_request
  inspecting_packet --&gt; analysing_reboot_request
  inspecting_packet --&gt; analysing_update
  rebooting
  rebooting --&gt; [*]
  rejecting_update
  rejecting_update --&gt; waiting
  sending_current_release_response
  sending_current_release_response --&gt; waiting
  testing_update
  testing_update --&gt; applying_update
  testing_update --&gt; rejecting_update
  waiting
  waiting --&gt; inspecting_packet
</code></pre>
<p>The states of <code>upgrade_listener</code> contain the following data:</p>
<ul>
<li>analysing_current_release_request:
<pre><code class="language-moonscript">packet: CurrentReleaseRequest,
</code></pre>
</li>
<li>analysing_reboot_request:
<pre><code class="language-moonscript">packet: RebootRequest,
</code></pre>
</li>
<li>analysing_update:
<pre><code class="language-moonscript">packet: MarshalBumpRelease,
</code></pre>
</li>
<li>applying_update:
<pre><code class="language-moonscript">release: Release,
</code></pre>
</li>
<li>broadcasting_reboot:
<em>none</em></li>
<li>inspecting_packet:
<pre><code class="language-moonscript">packet: Packet,
</code></pre>
</li>
<li>rebooting:
<em>none</em></li>
<li>rejecting_update:
<pre><code class="language-moonscript">instigator_id: number,
cause: string,
</code></pre>
</li>
<li>sending_current_release_response:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
recipient_id: number,
current_release: Release,
</code></pre>
</li>
<li>testing_update:
<pre><code class="language-moonscript">instigator_id: number,
release: Release,
</code></pre>
</li>
<li>waiting:
<em>none</em></li>
</ul>
<h2 id="config_listener"><a class="header" href="#config_listener"><code>config_listener</code></a></h2>
<pre><code class="language-mermaid">stateDiagram
  [*] --&gt; waiting
  analysing_get_config_request
  analysing_get_config_request --&gt; sending_get_config_response
  analysing_set_config_request
  analysing_set_config_request --&gt; sending_set_config_response
  inspecting_packet
  inspecting_packet --&gt; analysing_get_config_request
  inspecting_packet --&gt; analysing_set_config_request
  scheduling_config_application
  scheduling_config_application --&gt; waiting
  sending_get_config_response
  sending_get_config_response --&gt; waiting
  sending_set_config_response
  sending_set_config_response --&gt; scheduling_config_application
  sending_set_config_response --&gt; waiting
  waiting
  waiting --&gt; inspecting_packet
</code></pre>
<p>The states of <code>config_listener</code> contain the following data:</p>
<ul>
<li>analysing_get_config_request:
<pre><code class="language-moonscript">packet: GetConfigRequest,
</code></pre>
</li>
<li>analysing_set_config_request:
<pre><code class="language-moonscript">packet: SetConfigRequest,
</code></pre>
</li>
<li>inspecting_packet:
<pre><code class="language-moonscript">packet: Packet,
</code></pre>
</li>
<li>scheduling_config_application:
<pre><code class="language-moonscript">config: {},
</code></pre>
</li>
<li>sending_get_config_response:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
recipient_id: number,
raw: string,
</code></pre>
</li>
<li>sending_set_config_response:
<pre><code class="language-moonscript">idemp_tok: IdempotenceToken,
recipient_id: number,
response: { config: {} }
  | { error_reason: string },
error: ?string,
</code></pre>
</li>
<li>waiting:
<em>none</em></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="public-protocols"><a class="header" href="#public-protocols">Public protocols</a></h1>
<p>The following network interactions with Shunt are supported for external programs.</p>
<h2 id="declaretrainstate"><a class="header" href="#declaretrainstate"><code>DeclareTrainState</code></a></h2>
<pre><code class="language-mermaid">sequenceDiagram
    actor Requester
    participant Marshal

    Requester -) +Marshal: DeclareTrainState
    Marshal --) -Requester: DeclareTrainStateResponse
</code></pre>
<p>Types involved:</p>
<ul>
<li><a href="reference-materials/./types.html#declaretrainstate"><code>DeclareTrainState</code></a></li>
<li><a href="reference-materials/./types.html#declaretrainstateresponse"><code>DeclareTrainStateResponse</code></a></li>
</ul>
<h2 id="marshalidentityrequest"><a class="header" href="#marshalidentityrequest"><code>MarshalIdentityRequest</code></a></h2>
<!-- TODO(kcza): separate MarshalIdentityRequest and FactoryIdentityRequest to hide the latter -->
<pre><code class="language-mermaid">sequenceDiagram
    actor Requester
    participant Marshal

    Requester -) +Marshal: MarshalIdentityRequest
    Marshal --) -Requester: MarshalIdentityResponse
</code></pre>
<p>Types involved:</p>
<ul>
<li><a href="reference-materials/./types.html#marshalidentityrequest"><code>MarshalIdentityRequest</code></a></li>
<li><a href="reference-materials/./types.html#marshalidentityresponse"><code>MarshalIdentityResponse</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quicktype-notation"><a class="header" href="#quicktype-notation">Quicktype notation</a></h1>
<p>The quicktype notation is used to specify type constraints.
This section covers:</p>
<ul>
<li><a href="reference-materials/quicktype-notation/atomic-types.html">Atomic types</a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html">Composite types</a></li>
<li><a href="reference-materials/quicktype-notation/type-aliases.html">Type aliases</a></li>
<li><a href="reference-materials/quicktype-notation/subtyping.html">Subtyping</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="atomic-types"><a class="header" href="#atomic-types">Atomic types</a></h1>
<p>This section covers all quicktype types which cannot be broken down:</p>
<ul>
<li><a href="reference-materials/quicktype-notation/atomic-types.html#primitive">Primitive types – <code>nil</code>, <code>number</code>, …</a></li>
<li><a href="reference-materials/quicktype-notation/atomic-types.html#any">Universal type – <code>any</code></a></li>
<li><a href="reference-materials/quicktype-notation/atomic-types.html#some">Existential type – <code>some</code></a></li>
<li><a href="reference-materials/quicktype-notation/atomic-types.html#value-types">Value-types – <code>"str"</code>, <code>123</code></a></li>
<li><a href="reference-materials/quicktype-notation/atomic-types.html#never">Never type – <code>!</code></a></li>
</ul>
<h2 id="primitive"><a class="header" href="#primitive">Primitive types – <code>nil</code>, <code>number</code>, …</a></h2>
<p>All values returned from Lua’s <code>type</code> function are valid quicktype types.
All Lua 5.1 types are supported:</p>
<ul>
<li><code>nil</code></li>
<li><code>number</code></li>
<li><code>string</code></li>
<li><code>table</code></li>
<li><code>function</code></li>
<li><code>thread</code></li>
<li><code>userdata</code></li>
</ul>
<h2 id="any"><a class="header" href="#any">Universal type – <code>any</code></a></h2>
<p>A value of <code>any</code> type, including <code>nil</code>.</p>
<p>Examples:</p>
<ul>
<li><code>'hello'</code> implements <code>any</code></li>
<li><code>123</code> implements <code>any</code></li>
<li><code>nil</code> implements <code>any</code></li>
</ul>
<h2 id="some"><a class="header" href="#some">Existential type – <code>some</code></a></h2>
<p>A value implements <code>some</code> if it is not <code>nil</code>.</p>
<p>Examples:</p>
<ul>
<li><code>'hello'</code> implements <code>some</code></li>
<li><code>123</code> implements <code>some</code></li>
<li><code>nil</code> does <em>not</em> implement <code>some</code></li>
</ul>
<h2 id="value-types"><a class="header" href="#value-types">Value-types – <code>true</code>, “str”<code>, </code>123`</a></h2>
<p>A value implements a value-type if it is equal to the expected value.
Only <code>nil</code>, booleans, strings and numbers are supported as value-types.</p>
<p>Examples:</p>
<ul>
<li><code>nil</code> implements <code>nil</code></li>
<li><code>true</code> implements <code>true</code></li>
<li><code>'hello'</code> implements <code>"hello"</code></li>
<li><code>123</code> implements <code>123</code></li>
<li><code>123</code> does not implement <code>true</code></li>
<li><code>'hello'</code> does <em>not</em> implement <code>"world"</code></li>
</ul>
<h2 id="never"><a class="header" href="#never">Never type – <code>!</code></a></h2>
<p>The never type represents a value which can never exist.
This is typically only useful to represent <a href="reference-materials/quicktype-notation/./composite-types.html#functions-and-methods">functions</a> which never return.
E.g. a function which accepts no arguments and which either loops forever or kills the program implements <code>() -&gt; !</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="composite-types"><a class="header" href="#composite-types">Composite types</a></h1>
<p>This section covers all quicktype types which are composed of other types.</p>
<ul>
<li><a href="reference-materials/quicktype-notation/composite-types.html#option">Optionals – <code>?type</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#structs">Structs – <code>{field: type}</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#mappings">Mappings – <code>{type-&gt;type}</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#sets">Sets – <code>{type}</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#arrays">Arrays – <code>[type]</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#tuples">Tuples – <code>(type, type)</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#functions-and-methods">Functions and methods – <code>(type) -&gt; type</code>, <code>(type) =&gt; type</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#unions">Type unions – <code>type|type</code></a></li>
<li><a href="reference-materials/quicktype-notation/composite-types.html#intersections">Type intersections – <code>type+type</code></a></li>
</ul>
<h2 id="option"><a class="header" href="#option">Optionals – <code>?type</code></a></h2>
<p>An optional is a Lua value which is either <code>nil</code> or which implements the specified type.</p>
<p>Examples:</p>
<ul>
<li><code>nil</code> implements <code>?number</code></li>
<li><code>123</code> implements <code>?number</code></li>
<li><code>'hello'</code> does <em>not</em> implement <code>?number</code></li>
</ul>
<h2 id="structs"><a class="header" href="#structs">Structs – <code>{field: type}</code></a></h2>
<p>A struct is a Lua table in which all specified fields have the specified types.
Multiple fields may be specified as a comma-separated lists—<code>{field_1: type_1, field_2: type_2}</code>.</p>
<p>Examples:</p>
<ul>
<li><code>{hello = 'world'}</code> implements <code>{hello: string}</code></li>
<li><code>{}</code> implements <code>{hello: nil}</code></li>
<li><code>{hello = 123}</code> does <em>not</em> implement <code>{hello: string}</code></li>
<li><code>{hello = "world"}</code> does <em>not</em> implement <code>{hello: nil}</code></li>
</ul>
<p>The metatable of a struct can be constrained using the <code>&lt;&gt;</code> field.
For example, the constraint <code>{&lt;&gt;: { __add: function }, hello: string}</code> accepts structs with <code>hello</code> containing a string and whose metatable’s <code>__add</code> field contains a function.</p>
<p>By prepending a <code>~</code>, a struct becomes <em>table-like,</em> that is, it accepts indexable values which have the appropriate fields.</p>
<p>Examples:</p>
<ul>
<li><code>""</code> implements <code>~{len: function}</code></li>
<li><code>file</code> implements <code>~{write: function}</code></li>
<li><code>""</code> does <em>not</em> implement <code>{len: function}</code></li>
<li><code>file</code> does <em>not</em> implement <code>{write: function}</code></li>
</ul>
<h2 id="mappings"><a class="header" href="#mappings">Mappings – <code>{type-&gt;type}</code></a></h2>
<p>A mapping is a Lua table in which all keys have the same type and in which all values have the same type. The key type and value type may differ.</p>
<p>Examples:</p>
<ul>
<li><code>{}</code> implements <code>{string -&gt; number}</code></li>
<li><code>{hello = 1}</code> implements <code>{string -&gt; number}</code></li>
<li><code>{hello = 'world'}</code> does <em>not</em> implement <code>{string -&gt; number}</code></li>
</ul>
<p>The metatable of a mapping can be constrained using the <code>&lt;&gt;</code> field.
For example, the constraint <code>{&lt;&gt;: { __add: function }, string -&gt; number}</code> accepts mappings from strings to numbers whose metatable’s <code>__add</code> field contains a function.</p>
<h2 id="sets"><a class="header" href="#sets">Sets – <code>{type}</code></a></h2>
<p>A set is a Lua table in which all keys have the specified type and in which all values are truthy (i.e. not <code>false</code> or <code>nil</code>).</p>
<p>Examples:</p>
<ul>
<li><code>{}</code> implements <code>{string}</code></li>
<li><code>{'hello' = true}</code> implements <code>{string}</code></li>
<li><code>{‘hello’ = false}</code> does <em>not</em> implement <code>{string}</code></li>
<li><code>{[123] = true}</code> does <em>not</em> implement <code>{string}</code></li>
</ul>
<p>The metatable of a set can be constrained using the <code>&lt;&gt;</code> field.
For example, the constraint <code>{&lt;&gt;: { __add: function }, string}</code> accepts sets of strings whose metatable’s <code>__add</code> field contains a function.</p>
<h2 id="arrays"><a class="header" href="#arrays">Arrays – <code>[type]</code></a></h2>
<p>An array is a Lua table in which there exists a consecutive sequence of numeric keys starting at 1 and ending at some <em>n</em> for which all values have the specified type.
Further, the length of the table (defined by Lua’s <code>#</code> operator) is equal to <em>n.</em></p>
<p>Examples:</p>
<ul>
<li><code>{}</code> implements <code>[string]</code></li>
<li><code>{'hello', 'world'}</code> implements <code>[string]</code></li>
<li><code>{123}</code> does <em>not</em> implement <code>[string]</code></li>
<li><code>{'hello', 123}</code> does <em>not</em> implement <code>[string]</code></li>
<li><code>{[1] = 'hello', [3] = 123}</code> implements <code>[string]</code> <em>only</em> if Lua reports the length of this table as 1 or less<sup class="footnote-reference" id="fr-len-note-1"><a href="#footnote-len-note">1</a></sup></li>
</ul>
<p>The metatable of an array can be constrained using the <code>&lt;&gt;</code> field.
For example, the constraint <code>[&lt;&gt;: { __add: function }, string]</code> accepts sets of strings whose metatable’s <code>__add</code> field contains a function.</p>
<h2 id="tuples"><a class="header" href="#tuples">Tuples – <code>(type, type)</code></a></h2>
<p>A tuple is a Lua table in which the fields <em>1,</em> …, <em>n</em> have the respective, specified types.</p>
<p>Examples:</p>
<ul>
<li><code>{}</code> implements <code>()</code></li>
<li><code>{'hello'}</code> implements <code>(string)</code></li>
<li><code>{'hello', 'world'}</code> implements <code>(string, string)</code></li>
<li><code>{'hello', 123}</code> implements <code>(string, number)</code></li>
<li><code>{123, 123}</code> does <em>not</em> implement <code>(string, number)</code></li>
</ul>
<p>Metatable constraints are not currently supported on tables.</p>
<h2 id="functions-and-methods"><a class="header" href="#functions-and-methods">Functions and methods – <code>(type) -&gt; type</code>, <code>(type) =&gt; type</code></a></h2>
<p>A function is a Lua value which may be called, which expects to take parameters of the types specified and returns the specified values.
A function is specified using the <code>-&gt;</code> arrow.</p>
<p>A method is a special case of a function in which the first argument must be <code>some</code>.
A method is specified using the <code>=&gt;</code> arrow.</p>
<p>Examples:</p>
<ul>
<li><code>() -&gt; &lt;&gt;</code> represents a function which takes no parameters and returns no values</li>
<li><code>() -&gt; number</code> represents a function which returns a single number</li>
<li><code>(number) -&gt; number</code> represents a function which takes a single number and returns a single number</li>
<li><code>() -&gt; &lt;boolean, string&gt;</code> represents a function which takes no parameters and returns a boolean and a string</li>
<li><code>() -&gt; string...</code> represents a function which takes no parameters and returns any number of strings</li>
<li><code>(userdata, string...) -&gt; &lt;boolean, table...&gt;</code> represents a function which takes a userdata followed by any number of strings and returns a boolean followed by any number of tables</li>
<li><code>() =&gt; &lt;&gt;</code> represents a function which takes a non-<code>nil</code> parameter and returns no values.</li>
<li><code>(string) =&gt; &lt;&gt;</code> represents a function which takes a non-<code>nil</code> parameter followed by a string and returns no values.</li>
<li><code>() -&gt; !</code> represents a function which takes no parameters and never returns</li>
</ul>
<h2 id="unions"><a class="header" href="#unions">Type unions – <code>type|type</code></a></h2>
<p>A value implements a type union if and only if it implements at least one type in the union.</p>
<p>Examples:</p>
<ul>
<li><code>'hello'</code> implements <code>string|number</code></li>
<li><code>1</code> implements <code>string|number</code></li>
<li><code>'hello'</code> implements <code>"hello"|"world"</code></li>
<li><code>true</code> does <em>not</em> implement <code>string|number</code></li>
<li><code>'how do?'</code> does <em>not</em> implement <code>"hello"|"world"</code></li>
</ul>
<h2 id="intersections"><a class="header" href="#intersections">Type intersections – <code>type+type</code></a></h2>
<p>A value implements a type intersection if and only if it implements all types in the intersection.</p>
<p>Examples:</p>
<ul>
<li><code>'hello'</code> implements <code>string+"hello"</code></li>
<li><code>{hello = 'world', foo = 'bar'}</code> implements <code>{hello: string} + {foo: string}</code></li>
<li><code>{'hello', 'world'}</code> implements <code>[string]+{number}</code></li>
<li>Nothing implements <code>string+number</code></li>
</ul>
<hr>
<ol class="footnote-definition"><li id="footnote-len-note">
<p>The return value of Lua’s <code>#</code> operator when applied to tables containing keys which are outside of the consecutive 1 to <em>n</em> sequence (the array condition) is not specified in the standard. <a href="#fr-len-note-1">↩</a></p>
</li>
</ol><div style="break-before: page; page-break-before: always;"></div><h1 id="type-aliases"><a class="header" href="#type-aliases">Type aliases</a></h1>
<p>A type alias is a name given to a quicktype type.
Type aliases always start with an uppercase letter.</p>
<p>For example, a <code>BinaryTree</code> could be defined as:</p>
<pre><code class="language-moonscript">{ value: any }
| { left_child: BinaryTree, right_child: BinaryTree }
</code></pre>
<p>A type alias may have a <em>disambiguator</em> before a literal <code>.</code> in its name.
For example, a station in a marshal’s world-model could be differentiated from a Create station peripheral by calling one <code>marshal.Station</code> and the other <code>peripheral.Station</code>.</p>
<h2 id="the-self-type"><a class="header" href="#the-self-type">The <code>Self</code> type</a></h2>
<p>The <code>Self</code> type is an alias of <code>some</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="subtyping"><a class="header" href="#subtyping">Subtyping</a></h1>
<p>A type <em>T</em> is a subtype of a type <em>U</em> if and only if all values of type <em>T</em> implement <em>U.</em>
It is possible to use such a <em>T</em> in any place which accepts a <em>U.</em></p>
<p>Examples:</p>
<ul>
<li><code>{hello: string}</code> is a subtype of <code>{string-&gt;string}</code></li>
<li><code>[string]</code> is a subtype of <code>{number-&gt;string}</code></li>
<li><code>(string, string)</code> is a subtype of <code>[string]</code></li>
<li><code>(string|number) -&gt; "hello"</code> is a subtype of <code>(string) -&gt; string</code></li>
</ul>
<p>By design, quicktype always accepts subtypes.
For example, on many Lua distributions, the length (<code>#</code>) of a <a href="reference-materials/quicktype-notation/./composite-types.html#structs">struct</a> is always 0.
In such environments, all struct types are subtypes of all array types.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="types"><a class="header" href="#types">Types</a></h1>
<h2 id="availabletrain"><a class="header" href="#availabletrain"><code>AvailableTrain</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L102">Definition</a></p>
<pre><code class="language-moonscript">{
  at_factory: {
    name: string,
    pc_id: number,
  },
  at_station: {
    name: string,
  },
  name: string,
}
</code></pre>
<h2 id="clock"><a class="header" href="#clock"><code>Clock</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/clock.yue#L5">Definition</a></p>
<pre><code class="language-moonscript">{
  now: () =&gt; number,
}
</code></pre>
<h2 id="component"><a class="header" href="#component"><code>Component</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/component.yue#L5">Definition</a></p>
<pre><code class="language-moonscript">{
  events: Queue,
  step: () =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="configlistener"><a class="header" href="#configlistener"><code>ConfigListener</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/listener.yue#L11">Definition</a></p>
<pre><code class="language-moonscript">Component
</code></pre>
<h2 id="configlistenerevent"><a class="header" href="#configlistenerevent"><code>ConfigListenerEvent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/listener.yue#L12">Definition</a></p>
<pre><code class="language-moonscript">{
  type: "network-packet",
}
</code></pre>
<h2 id="configlisteneropts"><a class="header" href="#configlisteneropts"><code>ConfigListenerOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/listener.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">{
  config_type: string,
  target: Component + { config: some },
  uplink: Uplink,
}
</code></pre>
<h2 id="currentreleaserequest"><a class="header" href="#currentreleaserequest"><code>CurrentReleaseRequest</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/monitor.yue#L72">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: number,
  pc_id: number,
}
</code></pre>
<h2 id="declareargs"><a class="header" href="#declareargs"><code>DeclareArgs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/declare.yue#L11">Definition</a></p>
<pre><code class="language-moonscript">{
  train: ?{
    name: string,
    state: TrainState,
  },
}
</code></pre>
<h2 id="declaretrainstate-1"><a class="header" href="#declaretrainstate-1"><code>DeclareTrainState</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/declare.yue#L61">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  pc_id: number,
  train_name: string,
  state: TrainState,
}
</code></pre>
<h2 id="declaretrainstateresponse"><a class="header" href="#declaretrainstateresponse"><code>DeclareTrainStateResponse</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/declare.yue#L71">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  error_reason: ?string,
}
</code></pre>
<h2 id="deliveryoption"><a class="header" href="#deliveryoption"><code>DeliveryOption</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L97">Definition</a></p>
<pre><code class="language-moonscript">{
  inbound_station: string,
  outbound_station: string,
  train: AvailableTrain,
}
</code></pre>
<h2 id="deliveryoptionset"><a class="header" href="#deliveryoptionset"><code>DeliveryOptionSet</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L92">Definition</a></p>
<pre><code class="language-moonscript">{
  inbound_station: StationAddress,
  outbound_stations: [StationAddress],
  trains: [AvailableTrain],
}
</code></pre>
<h2 id="detectedstations"><a class="header" href="#detectedstations"><code>DetectedStations</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L349">Definition</a></p>
<pre><code class="language-moonscript">{
  known: [KnownDetectedStation],
  unknown: [UnknownDetectedStation],
}
</code></pre>
<h2 id="detectedstockpile"><a class="header" href="#detectedstockpile"><code>DetectedStockpile</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L362">Definition</a></p>
<pre><code class="language-moonscript">{
  known: [StockpileItemInfo],
  unknown: [StoredItemInfo],
  estimated_capacity: number,
}
</code></pre>
<h2 id="detectedtrains"><a class="header" href="#detectedtrains"><code>DetectedTrains</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L358">Definition</a></p>
<pre><code class="language-moonscript">{
  capacity: number,
  present_trains: [string],
}
</code></pre>
<h2 id="displayconfig"><a class="header" href="#displayconfig"><code>DisplayConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/display/main.yue#L20">Definition</a></p>
<pre><code class="language-moonscript">{
  display: {
    ledger: {
      kind: "trains"|"factories"|"throughput"|"events",
    },
  },
}
</code></pre>
<h2 id="drive"><a class="header" href="#drive"><code>Drive</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/drive.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  is_disk_present: () =&gt; boolean,
  mount_path: () =&gt; ?string,
  disk_label: () =&gt; ?string,
  set_disk_label: (?string) =&gt; boolean,
}
</code></pre>
<h2 id="editargs"><a class="header" href="#editargs"><code>EditArgs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/edit.yue#L16">Definition</a></p>
<pre><code class="language-moonscript">{
  marshal: ?EditMarshalArgs,
  factory: ?EditFactoryArgs,
}
</code></pre>
<h2 id="editfactoryargs"><a class="header" href="#editfactoryargs"><code>EditFactoryArgs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/edit.yue#L21">Definition</a></p>
<pre><code class="language-moonscript">{
  which: string,
}
</code></pre>
<h2 id="editmarshalargs"><a class="header" href="#editmarshalargs"><code>EditMarshalArgs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/edit.yue#L20">Definition</a></p>
<pre><code class="language-moonscript">{}
</code></pre>
<h2 id="editor"><a class="header" href="#editor"><code>Editor</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/editor.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  edit_file: (string) =&gt; ?string,
  edit_text: (
      string,
      string,
      ?(string) -&gt; boolean,
      ?(string, number) -&gt; ?ABORT
    ) =&gt; &lt;?string, ?string&gt;,
}
</code></pre>
<h2 id="editorbackend"><a class="header" href="#editorbackend"><code>EditorBackend</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/editor.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">{
  edit_file: (string) =&gt; ?string,
}
</code></pre>
<h2 id="entry"><a class="header" href="#entry"><code>Entry</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/ledger/main.yue#L38">Definition</a></p>
<pre><code class="language-moonscript">{
  when: string,
  what: string,
  how: string,
}
</code></pre>
<h2 id="factory"><a class="header" href="#factory"><code>Factory</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L55">Definition</a></p>
<pre><code class="language-moonscript">{
  -- Constant
  name: string,
  pc_id: number,
  -- Variable
  last_seen_epoch: number,
  stations: DetectedStations,
  stockpile: DetectedStockpile,
}
</code></pre>
<h2 id="factoryconfig"><a class="header" href="#factoryconfig"><code>FactoryConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L126">Definition</a></p>
<pre><code class="language-moonscript">{
  factory: {
    name: string,
  },
  stockpile: [StockpileConfig],
  stations: [StationConfig],
}
</code></pre>
<h2 id="factoryheartbeat"><a class="header" href="#factoryheartbeat"><code>FactoryHeartbeat</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L343">Definition</a></p>
<pre><code class="language-moonscript">{
  pc_id: number,
  name: string,
  stations: DetectedStations,
  stockpile: DetectedStockpile,
}
</code></pre>
<h2 id="firewall"><a class="header" href="#firewall"><code>Firewall</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/firewall.yue#L8">Definition</a></p>
<pre><code class="language-moonscript">{
  add_child: (Firewall) =&gt; &lt;&gt;,
  permits: (Packet) =&gt; boolean,
}
</code></pre>
<h2 id="flashargs"><a class="header" href="#flashargs"><code>FlashArgs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/flash.yue#L14">Definition</a></p>
<pre><code class="language-moonscript">{
  drive: ?string,
}
</code></pre>
<h2 id="getconfigrequest"><a class="header" href="#getconfigrequest"><code>GetConfigRequest</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/main.yue#L140">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  pc_id: number,
}
</code></pre>
<h2 id="idempotencetoken"><a class="header" href="#idempotencetoken"><code>IdempotenceToken</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L219">Definition</a></p>
<pre><code class="language-moonscript">number
</code></pre>
<h2 id="instigatoropts"><a class="header" href="#instigatoropts"><code>InstigatorOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/instigator.yue#L11">Definition</a></p>
<pre><code class="language-moonscript">{
  config: ?{},
  pc: Pc,
  rebooter: ?Rebooter,
  release: Release,
  uplink: ?Uplink,
}
</code></pre>
<h2 id="inventory"><a class="header" href="#inventory"><code>Inventory</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L34">Definition</a></p>
<pre><code class="language-moonscript">{
  gather_content: ({string-&gt;StoredItemInfo}) =&gt; number,
}
</code></pre>
<h2 id="inventorybackend"><a class="header" href="#inventorybackend"><code>InventoryBackend</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L37">Definition</a></p>
<pre><code class="language-moonscript">{
  size: () =&gt; number,
  slot_content: (number) =&gt; ?SlotContent,
  slot_capacity: (number) =&gt; number,
}
</code></pre>
<h2 id="knowndetectedstation"><a class="header" href="#knowndetectedstation"><code>KnownDetectedStation</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L353">Definition</a></p>
<pre><code class="language-moonscript">StationConfig + DetectedTrains
</code></pre>
<h2 id="ledger"><a class="header" href="#ledger"><code>Ledger</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/ledger/main.yue#L35">Definition</a></p>
<pre><code class="language-moonscript">{
  iter: () =&gt; thread,
}
</code></pre>
<h2 id="ledgerconfig"><a class="header" href="#ledgerconfig"><code>LedgerConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/ledger/main.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">{
  ledger: {
    retained-events: number,
  },
}
</code></pre>
<h2 id="ledgerfmtopts"><a class="header" href="#ledgerfmtopts"><code>LedgerFmtOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/ledger/main.yue#L148">Definition</a></p>
<pre><code class="language-moonscript">{
  max_rows: number,
  width: number,
}
</code></pre>
<h2 id="marshalconfig"><a class="header" href="#marshalconfig"><code>MarshalConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L73">Definition</a></p>
<pre><code class="language-moonscript">{
  marshal: {
    resend_cooldown_seconds: ?number,
  },
}
</code></pre>
<h2 id="marshalevent"><a class="header" href="#marshalevent"><code>MarshalEvent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L78">Definition</a></p>
<pre><code class="language-moonscript">{
  type: "network-packet",
  packet: Packet,
} | {
  type: "new-epoch",
  new_epoch: number,
} | {
  type: "new-config",
  config: MarshalConfig,
}
</code></pre>
<h2 id="marshalidentityrequest-1"><a class="header" href="#marshalidentityrequest-1"><code>MarshalIdentityRequest</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/main.yue#L123">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  pc_id: number,
  name: ?string,
}
</code></pre>
<h2 id="marshalidentityresponse"><a class="header" href="#marshalidentityresponse"><code>MarshalIdentityResponse</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/main.yue#L132">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  resp: number|string,
}
</code></pre>
<h2 id="marshalopts"><a class="header" href="#marshalopts"><code>MarshalOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L117">Definition</a></p>
<pre><code class="language-moonscript">{
  config: MarshalConfig+StoredConfig,
  pc: Pc,
  uplink: Uplink,
  rand: ?Random,
  clock: ?Clock,
}
</code></pre>
<h2 id="marshalsnapshot"><a class="header" href="#marshalsnapshot"><code>MarshalSnapshot</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L112">Definition</a></p>
<pre><code class="language-moonscript">{
  version: number,
  epoch: number,
  promise_tracker_snapshot: PromiseTrackerSnapshot,
}
</code></pre>
<h2 id="multiplexer"><a class="header" href="#multiplexer"><code>Multiplexer</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/data/multiplexer.yue#L10">Definition</a></p>
<pre><code class="language-moonscript">{
  add: (() -&gt; &lt;&gt;) =&gt; &lt;&gt;,
  send: (some) =&gt; &lt;&gt;,
  stream: () =&gt; function,
}
</code></pre>
<h2 id="network"><a class="header" href="#network"><code>Network</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L51">Definition</a></p>
<pre><code class="language-moonscript">{
  name: string,
  factories: [Factory],
}
</code></pre>
<h2 id="networkcomponent"><a class="header" href="#networkcomponent"><code>NetworkComponent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/component.yue#L9">Definition</a></p>
<pre><code class="language-moonscript">Component + {
  firewall: Firewall,
}
</code></pre>
<h2 id="networkframe"><a class="header" href="#networkframe"><code>NetworkFrame</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L111">Definition</a></p>
<pre><code class="language-moonscript">{ from_id: number } + NetworkFrameData
</code></pre>
<h2 id="networkframedata"><a class="header" href="#networkframedata"><code>NetworkFrameData</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L114">Definition</a></p>
<pre><code class="language-moonscript">{
  packet: any,
  protocol: ?string,
}
</code></pre>
<h2 id="networkframespec"><a class="header" href="#networkframespec"><code>NetworkFrameSpec</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L110">Definition</a></p>
<pre><code class="language-moonscript">NetworkFrame | () -&gt; NetworkFrame
</code></pre>
<h2 id="packet"><a class="header" href="#packet"><code>Packet</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L88">Definition</a></p>
<pre><code class="language-moonscript">{
  protocol: string,
}
</code></pre>
<h2 id="packettype"><a class="header" href="#packettype"><code>PacketType</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L91">Definition</a></p>
<pre><code class="language-moonscript">{
  protocol: () =&gt; string,
}
</code></pre>
<h2 id="pc"><a class="header" href="#pc"><code>Pc</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/pc.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  id: () =&gt; number,
  name: () =&gt; ?string,
}
</code></pre>
<h2 id="pcbackend"><a class="header" href="#pcbackend"><code>PcBackend</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/pc.yue#L10">Definition</a></p>
<pre><code class="language-moonscript">Pc
</code></pre>
<h2 id="peripheraltype"><a class="header" href="#peripheraltype"><code>PeripheralType</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L72">Definition</a></p>
<pre><code class="language-moonscript">"modem"
</code></pre>
<h2 id="promise"><a class="header" href="#promise"><code>Promise</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/promise_tracker.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">{
  id: number,
  train: string,
  stations: ?[PromiseStation],
  should_approach_index: number,
  deadline: ?number,
  max_step_duration: number,
  lost: boolean,
}
</code></pre>
<h2 id="promiseset"><a class="header" href="#promiseset"><code>PromiseSet</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/promise_tracker.yue#L28">Definition</a></p>
<pre><code class="language-moonscript">{
  count: number,
  promises: {number},
}
</code></pre>
<h2 id="promisestation"><a class="header" href="#promisestation"><code>PromiseStation</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/promise_tracker.yue#L24">Definition</a></p>
<pre><code class="language-moonscript">{
  name: string,
  capacity: number,
}
</code></pre>
<h2 id="promisetracker"><a class="header" href="#promisetracker"><code>PromiseTracker</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/promise_tracker.yue#L8">Definition</a></p>
<pre><code class="language-moonscript">{
  promise: (string, [PromiseStation], ?number, ?number) =&gt; Promise,
  break_promise: (Promise) =&gt; &lt;&gt;,
  train_is_promised: (string) =&gt; boolean,
  station_is_fully_promised: (string) =&gt; boolean,
  declare_train_seen: (string, string) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="promisetrackersnapshot"><a class="header" href="#promisetrackersnapshot"><code>PromiseTrackerSnapshot</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/promise_tracker.yue#L32">Definition</a></p>
<pre><code class="language-moonscript">[Promise]
</code></pre>
<h2 id="queue"><a class="header" href="#queue"><code>Queue</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/data/queue.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  len: () =&gt; number,
  enqueue: (some) =&gt; &lt;&gt;,
  dequeue: () =&gt; ?some,
  extract: ((some) -&gt; boolean) =&gt; ?some,
  peek: () =&gt; ?some,
  iter: () =&gt; function,
}
</code></pre>
<h2 id="random"><a class="header" href="#random"><code>Random</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/util/pseudo_random.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  random: (number) =&gt; number,
  pick: ([some]) =&gt; ?some,
  shuffle: ([some]) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="rebooter"><a class="header" href="#rebooter"><code>Rebooter</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/rebooter.yue#L7">Definition</a></p>
<pre><code class="language-moonscript">{
  reboot: () =&gt; !,
}
</code></pre>
<h2 id="release"><a class="header" href="#release"><code>Release</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/upgrade.yue#L40">Definition</a></p>
<pre><code class="language-moonscript">{
  file: string,
  version: string,
  content: string,
}
</code></pre>
<h2 id="resource"><a class="header" href="#resource"><code>Resource</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L35">Definition</a></p>
<pre><code class="language-moonscript">{
  id: () =&gt; string,
  kind: () =&gt; "cargo"|"player"
}
</code></pre>
<h2 id="resourceorchestrator"><a class="header" href="#resourceorchestrator"><code>ResourceOrchestrator</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/main.yue#L11">Definition</a></p>
<pre><code class="language-moonscript">NetworkComponent + {
  factory: (string) =&gt; ?Factory,
  train_is_known: (string) =&gt; boolean,
}
</code></pre>
<h2 id="resourceorchestratorevent"><a class="header" href="#resourceorchestratorevent"><code>ResourceOrchestratorEvent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/main.yue#L17">Definition</a></p>
<pre><code class="language-moonscript">{
  type: "network-packet",
  packet: Packet,
} | {
  type: "new-epoch",
  new_epoch: number,
} | {
  type: "new-config",
  config: MarshalConfig,
}
</code></pre>
<h2 id="resourceorchestratoropts"><a class="header" href="#resourceorchestratoropts"><code>ResourceOrchestratorOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/main.yue#L27">Definition</a></p>
<pre><code class="language-moonscript">{
  clock: Clock,
  config: MarshalConfig,
  scheduler: Scheduler,
  uplink: Uplink,
}
</code></pre>
<h2 id="schedule"><a class="header" href="#schedule"><code>Schedule</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L17">Definition</a></p>
<pre><code class="language-moonscript">{
  cyclic: boolean,
  entries: [ScheduleEntry],
}
</code></pre>
<h2 id="schedulecandidate"><a class="header" href="#schedulecandidate"><code>ScheduleCandidate</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L20">Definition</a></p>
<pre><code class="language-moonscript">{
  train_addr: TrainAddress,
  inbound_station_addr: StationAddress,
  outbound_station_addr: StationAddress,
  schedule: Schedule,
  info: {
    inbound_factory_name: string,
    resource: string,
  },
}
</code></pre>
<h2 id="schedulegenerator"><a class="header" href="#schedulegenerator"><code>ScheduleGenerator</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L198">Definition</a></p>
<pre><code class="language-moonscript">{
  try_generate_schedule: () =&gt; &lt;?ScheduleCandidate, boolean&gt;,
  end_generation: () =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="schedulegeneratorimplopts"><a class="header" href="#schedulegeneratorimplopts"><code>ScheduleGeneratorImplOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L351">Definition</a></p>
<pre><code class="language-moonscript">{
  factories: [Factory],
  factory: Factory,
  promise_tracker: PromiseTracker,
  rand: Random,
  resource: string,
}
</code></pre>
<h2 id="schedulegeneratoropts"><a class="header" href="#schedulegeneratoropts"><code>ScheduleGeneratorOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L202">Definition</a></p>
<pre><code class="language-moonscript">{
  factories: [Factory],
  factory: Factory,
  parent_scheduler: Scheduler,
  rand: Random,
  resource: string,
}
</code></pre>
<h2 id="schedulerequest"><a class="header" href="#schedulerequest"><code>ScheduleRequest</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L321">Definition</a></p>
<pre><code class="language-moonscript">Packet + {
  idemp_tok: IdempotenceToken,
  station_name: string,
  train_name: string,
  schedule: Schedule,
}
</code></pre>
<h2 id="scheduleresponse"><a class="header" href="#scheduleresponse"><code>ScheduleResponse</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L333">Definition</a></p>
<pre><code class="language-moonscript">Packet + {
  idemp_tok: IdempotenceToken,
  error_reason: ?string,
}
</code></pre>
<h2 id="scheduler-1"><a class="header" href="#scheduler-1"><code>Scheduler</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">{
  events: Queue,
  schedule_generator: (string, Factory, [Factory]) =&gt; ScheduleGenerator,
  train_is_lost: (string) =&gt; boolean,
}
</code></pre>
<h2 id="schedulerevent"><a class="header" href="#schedulerevent"><code>SchedulerEvent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L34">Definition</a></p>
<pre><code class="language-moonscript">{
  type: "network-packet",
  packet: Packet,
} | {
  type: "start-scheduling",
  schedule_generator: ScheduleGenerator,
} | {
  type: "declare-train-state",
  train_name: string,
  state: TrainState,
}
</code></pre>
<h2 id="scheduleropts"><a class="header" href="#scheduleropts"><code>SchedulerOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L45">Definition</a></p>
<pre><code class="language-moonscript">{
  clock: Clock,
  rand: Random,
}
</code></pre>
<h2 id="self"><a class="header" href="#self"><code>Self</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/quicktype.yue#L1363">Definition</a></p>
<pre><code class="language-moonscript">some
</code></pre>
<h2 id="setconfigrequest"><a class="header" href="#setconfigrequest"><code>SetConfigRequest</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/main.yue#L152">Definition</a></p>
<pre><code class="language-moonscript">{
  idemp_tok: IdempotenceToken,
  pc_id: number,
  raw: string,
}
</code></pre>
<h2 id="slotcontent"><a class="header" href="#slotcontent"><code>SlotContent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L11">Definition</a></p>
<pre><code class="language-moonscript">{
  displayName: string,
  count: number,
}
</code></pre>
<h2 id="slotdata"><a class="header" href="#slotdata"><code>SlotData</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L7">Definition</a></p>
<pre><code class="language-moonscript">{
  name: string,
  count: number,
}
</code></pre>
<h2 id="state"><a class="header" href="#state"><code>State</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/state.yue#L269">Definition</a></p>
<pre><code class="language-moonscript">{
  _is_end: boolean,
  _transitions: {string},
  _data_type: ?string,
}
</code></pre>
<h2 id="statemachine"><a class="header" href="#statemachine"><code>StateMachine</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/state.yue#L305">Definition</a></p>
<pre><code class="language-moonscript">{
  state: {name: string},
  goto: (string, ?{string -&gt; any}) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="stateresponses"><a class="header" href="#stateresponses"><code>StateResponses</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/state.yue#L313">Definition</a></p>
<pre><code class="language-moonscript">{string-&gt;()-&gt;&lt;&gt;}
</code></pre>
<h2 id="station"><a class="header" href="#station"><code>Station</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L40">Definition</a></p>
<pre><code class="language-moonscript">{
  name: () =&gt; StationName,
  train_name: () =&gt; ?string,
  apply_schedule: (Schedule) =&gt; boolean,
}
</code></pre>
<h2 id="stationaddress"><a class="header" href="#stationaddress"><code>StationAddress</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L88">Definition</a></p>
<pre><code class="language-moonscript">{
  factory: Factory,
  station: StationConfig,
}
</code></pre>
<h2 id="stationbackend"><a class="header" href="#stationbackend"><code>StationBackend</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L6">Definition</a></p>
<pre><code class="language-moonscript">{
  name: () =&gt; StationName,
  set_name: (StationName) =&gt; &lt;&gt;,
  train_present: () =&gt; boolean,
  train_enroute: () =&gt; boolean,
  train_has_schedule: () =&gt; ?boolean,
  train_schedule: () =&gt; ?Schedule,
  train_set_schedule: (Schedule) =&gt; boolean,
  train_name: () =&gt; ?string,
}
</code></pre>
<h2 id="stationconfig"><a class="header" href="#stationconfig"><code>StationConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L146">Definition</a></p>
<pre><code class="language-moonscript">{
  name: string,
  type: "inbound"|"outbound",
  handles: string,
  network: string,
}
</code></pre>
<h2 id="stationinfo"><a class="header" href="#stationinfo"><code>StationInfo</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L45">Definition</a></p>
<pre><code class="language-moonscript">{
  name: StationName,
  train_name: ?string,
}
</code></pre>
<h2 id="stationname"><a class="header" href="#stationname"><code>StationName</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L16">Definition</a></p>
<pre><code class="language-moonscript">string
</code></pre>
<h2 id="stationperipheral"><a class="header" href="#stationperipheral"><code>StationPeripheral</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L91">Definition</a></p>
<pre><code class="language-moonscript">{
  getStationName: () =&gt; StationName,
}
</code></pre>
<h2 id="stockpile"><a class="header" href="#stockpile"><code>Stockpile</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L16">Definition</a></p>
<pre><code class="language-moonscript">{
  content: () =&gt; StockpileContent,
}
</code></pre>
<h2 id="stockpileconfig"><a class="header" href="#stockpileconfig"><code>StockpileConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L133">Definition</a></p>
<pre><code class="language-moonscript">{name: string}
  + StockpileLevelConfig
</code></pre>
<h2 id="stockpilecontent"><a class="header" href="#stockpilecontent"><code>StockpileContent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L69">Definition</a></p>
<pre><code class="language-moonscript">{
  stored_items: [StoredItemInfo],
  estimated_capacity: number,
}
</code></pre>
<h2 id="stockpileiteminfo"><a class="header" href="#stockpileiteminfo"><code>StockpileItemInfo</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L367">Definition</a></p>
<pre><code class="language-moonscript">StoredItemInfo + StockpileConfig
</code></pre>
<h2 id="stockpilelevelconfig"><a class="header" href="#stockpilelevelconfig"><code>StockpileLevelConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L137">Definition</a></p>
<pre><code class="language-moonscript">{
  surplus_amount: number,
  shortage_amount: ?number,
} | {
  surplus_amount: ?number,
  shortage_amount: number,
}
</code></pre>
<h2 id="storedconfig"><a class="header" href="#storedconfig"><code>StoredConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/config.yue#L9">Definition</a></p>
<pre><code class="language-moonscript">{
  &lt;&gt;: {
    __raw: string,
  },
}
</code></pre>
<h2 id="storediteminfo"><a class="header" href="#storediteminfo"><code>StoredItemInfo</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L73">Definition</a></p>
<pre><code class="language-moonscript">{
  name: string,
  stored: number,
}
</code></pre>
<h2 id="testdriveopts"><a class="header" href="#testdriveopts"><code>TestDriveOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/drive.yue#L48">Definition</a></p>
<pre><code class="language-moonscript">{
  is_disk_present: ?() =&gt; boolean,
  mount_path: ?() =&gt; ?string,
  disk_label: ?() =&gt; ?string,
  set_disk_label: ?(?string) =&gt; boolean,
}
</code></pre>
<h2 id="testeditorbackendopts"><a class="header" href="#testeditorbackendopts"><code>TestEditorBackendOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/configurator/editor.yue#L74">Definition</a></p>
<pre><code class="language-moonscript">{
  edit_file: ?(string) =&gt; ?string,
}
</code></pre>
<h2 id="testinventorybackendopts"><a class="header" href="#testinventorybackendopts"><code>TestInventoryBackendOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/stockpile.yue#L96">Definition</a></p>
<pre><code class="language-moonscript">{
  size: ?() =&gt; number,
  list: ?() =&gt; {number-&gt;SlotData},
  slot_content: ?(number) =&gt; ?SlotContent,
  slot_capacity: ?(number) =&gt; number,
}
</code></pre>
<h2 id="testpcbackendopts"><a class="header" href="#testpcbackendopts"><code>TestPcBackendOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/pc.yue#L33">Definition</a></p>
<pre><code class="language-moonscript">{
  id: ?() =&gt; number,
  name: ?() =&gt; ?string,
  set_name: ?(string) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="teststationbackendopts"><a class="header" href="#teststationbackendopts"><code>TestStationBackendOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L146">Definition</a></p>
<pre><code class="language-moonscript">{
  name: ?() =&gt; StationName,
  set_name: ?(StationName) =&gt; &lt;&gt;,
  train_present: ?() =&gt; boolean,
  train_enroute: ?() =&gt; boolean,
  train_has_schedule: ?() =&gt; ?boolean,
  train_schedule: ?() =&gt; ?Schedule,
  train_set_schedule: ?(Schedule) =&gt; boolean,
  train_name: ?() =&gt; ?string,
}
</code></pre>
<h2 id="testuplinkbackendopts"><a class="header" href="#testuplinkbackendopts"><code>TestUplinkBackendOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L104">Definition</a></p>
<pre><code class="language-moonscript">{
  to_receive: ?[NetworkFrameSpec] | () -&gt; [NetworkFrameSpec],
  on_send: ?(number, any, ?string) =&gt; boolean,
  on_receive: ?(?string, ?number) =&gt; &lt;?number|boolean, any|TIMEOUT, ?string&gt;,
  on_broadcast: ?(any, ?string) =&gt; boolean,
}
</code></pre>
<h2 id="timeunit"><a class="header" href="#timeunit"><code>TimeUnit</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/station.yue#L34">Definition</a></p>
<pre><code class="language-moonscript">0|1|2
</code></pre>
<h2 id="trainaddress"><a class="header" href="#trainaddress"><code>TrainAddress</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/resource_orchestrator/scheduler.yue#L30">Definition</a></p>
<pre><code class="language-moonscript">{ name: string }
  + StationAddress
</code></pre>
<h2 id="trainstate"><a class="header" href="#trainstate"><code>TrainState</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/cmd/declare.yue#L17">Definition</a></p>
<pre><code class="language-moonscript">"cleared"|"reserved"
</code></pre>
<h2 id="trainstatus"><a class="header" href="#trainstatus"><code>TrainStatus</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/marshal/main.yue#L64">Definition</a></p>
<pre><code class="language-moonscript">{
  -- Constant:
  name: string,
  -- Variable:
  last_seen_epoch: number,
  last_seen_at_factory: string,
  last_seen_at_station: string,
}
</code></pre>
<h2 id="unknowndetectedstation"><a class="header" href="#unknowndetectedstation"><code>UnknownDetectedStation</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/nodes/factory/main.yue#L354">Definition</a></p>
<pre><code class="language-moonscript">{ name: string }
  + DetectedTrains
</code></pre>
<h2 id="upgradelistener"><a class="header" href="#upgradelistener"><code>UpgradeListener</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/listener.yue#L14">Definition</a></p>
<pre><code class="language-moonscript">NetworkComponent
</code></pre>
<h2 id="upgradelistenerconfig"><a class="header" href="#upgradelistenerconfig"><code>UpgradeListenerConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/listener.yue#L25">Definition</a></p>
<pre><code class="language-moonscript">{
  marshal: ?{},
}
</code></pre>
<h2 id="upgradelistenerevent"><a class="header" href="#upgradelistenerevent"><code>UpgradeListenerEvent</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/listener.yue#L16">Definition</a></p>
<pre><code class="language-moonscript">{
  type: "network-packet",
  packet: Packet,
}
</code></pre>
<h2 id="upgradelistenerkind"><a class="header" href="#upgradelistenerkind"><code>UpgradeListenerKind</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/listener.yue#L15">Definition</a></p>
<pre><code class="language-moonscript">"leader"|"follower"
</code></pre>
<h2 id="upgradelisteneropts"><a class="header" href="#upgradelisteneropts"><code>UpgradeListenerOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/listener.yue#L20">Definition</a></p>
<pre><code class="language-moonscript">{
  config: UpgradeListenerConfig,
  uplink: Uplink,
  rebooter: ?Rebooter,
}
</code></pre>
<h2 id="upgrademonitorconfig"><a class="header" href="#upgrademonitorconfig"><code>UpgradeMonitorConfig</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/monitor.yue#L10">Definition</a></p>
<pre><code class="language-moonscript">{
  marshal: ?{},
}
</code></pre>
<h2 id="upgrademonitoropts"><a class="header" href="#upgrademonitoropts"><code>UpgradeMonitorOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/upgrade/monitor.yue#L13">Definition</a></p>
<pre><code class="language-moonscript">{
  config: UpgradeMonitorConfig,
  pc: Pc,
  uplink: Uplink,
}
</code></pre>
<h2 id="uplink"><a class="header" href="#uplink"><code>Uplink</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L16">Definition</a></p>
<pre><code class="language-moonscript">{
  broadcast: (Packet) =&gt; &lt;&gt;,
  send_to: (number, Packet) =&gt; &lt;&gt;,
  receive_from_any: (Packet, ?UplinkReceiveOpts) =&gt; &lt;?number, Packet|TIMEOUT&gt;,
  receive_from: (number, Packet, ?UplinkReceiveOpts) =&gt; &lt;?number, Packet|TIMEOUT&gt;,
}
</code></pre>
<h2 id="uplinkbackend"><a class="header" href="#uplinkbackend"><code>UplinkBackend</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L10">Definition</a></p>
<pre><code class="language-moonscript">{
  send: (number, any, ?string) =&gt; boolean,
  receive: (?string, ?number) =&gt; &lt;?number, any, ?string&gt;,
  broadcast: (any, ?string) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="uplinkreceiveopts"><a class="header" href="#uplinkreceiveopts"><code>UplinkReceiveOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/peripheral/uplink.yue#L68">Definition</a></p>
<pre><code class="language-moonscript">{
  timeout: ?number,
}
</code></pre>
<h2 id="whence"><a class="header" href="#whence"><code>Whence</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L427">Definition</a></p>
<pre><code class="language-moonscript">"set"|"cur"|"end"
</code></pre>
<h2 id="writelitedelta"><a class="header" href="#writelitedelta"><code>writelite.Delta</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L428">Definition</a></p>
<pre><code class="language-moonscript">{
  offset: number,
  content: string,
}
</code></pre>
<h2 id="writelitedeserialisersource"><a class="header" href="#writelitedeserialisersource"><code>writelite.DeserialiserSource</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L875">Definition</a></p>
<pre><code class="language-moonscript">string|writelite.File
</code></pre>
<h2 id="writelitefile"><a class="header" href="#writelitefile"><code>writelite.File</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L310">Definition</a></p>
<pre><code class="language-moonscript">read: ("*a"|number) =&gt; &lt;?string, ?string&gt;,
write: (string) =&gt; ?string,
seek: (Whence, ?number) =&gt; &lt;?number, ?string&gt;,
setvbuf: ("full") =&gt; &lt;&gt;,
flush: () =&gt; &lt;boolean, ?string&gt;,
close: () =&gt; &lt;boolean, ?string&gt;,
}
</code></pre>
<h2 id="writelitefilemode"><a class="header" href="#writelitefilemode"><code>writelite.FileMode</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L304">Definition</a></p>
<pre><code class="language-moonscript">"r"|"w"|"a"
|"r+"|"w+"|"a+"
|"rb"|"wb"|"ab"
|"rb+"|"wb+"|"ab+"
</code></pre>
<h2 id="writelitefs"><a class="header" href="#writelitefs"><code>writelite.Fs</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L300">Definition</a></p>
<pre><code class="language-moonscript">{
  open: (string, writelite.FileMode) =&gt; &lt;?writelite.File, ?string, ?number&gt;,
  remove: (string) =&gt; boolean,
}
</code></pre>
<h2 id="writelitehasher"><a class="header" href="#writelitehasher"><code>writelite.Hasher</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L1032">Definition</a></p>
<pre><code class="language-moonscript">{
  hash: (any) =&gt; number,
  write: (string) =&gt; &lt;&gt;,
  finish: () =&gt; number,
}
</code></pre>
<h2 id="writelitejournal"><a class="header" href="#writelitejournal"><code>writelite.Journal</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L652">Definition</a></p>
<pre><code class="language-moonscript">{
  pages: () =&gt; [writelite.Page],
  add: (writelite.Page) =&gt; &lt;&gt;,
  write_to: (writelite.File) =&gt; &lt;boolean, ?string&gt;,
}
</code></pre>
<h2 id="writelitejournalheader"><a class="header" href="#writelitejournalheader"><code>writelite.JournalHeader</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L657">Definition</a></p>
<pre><code class="language-moonscript">{
  format_version: 1,
  page_size: number,
  mode: writelite.JournalMode,
  payload_length: number,
}
</code></pre>
<h2 id="writelitejournalmode"><a class="header" href="#writelitejournalmode"><code>writelite.JournalMode</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L663">Definition</a></p>
<pre><code class="language-moonscript">"delete"
</code></pre>
<h2 id="writelitemainheader"><a class="header" href="#writelitemainheader"><code>writelite.MainHeader</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L57">Definition</a></p>
<pre><code class="language-moonscript">{
  format_version: 1,
  page_size: number,
  mode: writelite.Mode,
}
</code></pre>
<h2 id="writelitemode"><a class="header" href="#writelitemode"><code>writelite.Mode</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L56">Definition</a></p>
<pre><code class="language-moonscript">"blob"
</code></pre>
<h2 id="writelitepage"><a class="header" href="#writelitepage"><code>writelite.Page</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L1014">Definition</a></p>
<pre><code class="language-moonscript">{
  offset: number,
  content: string,
  checksum: number,
}
</code></pre>
<h2 id="writelitepagecache"><a class="header" href="#writelitepagecache"><code>writelite.PageCache</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L327">Definition</a></p>
<pre><code class="language-moonscript">{
  get: (number) =&gt; ?writelite.Page,
  set: (number, writelite.Page) =&gt; &lt;&gt;,
  set_max_cached_pages: (number) =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="writelitepagecacheopts"><a class="header" href="#writelitepagecacheopts"><code>writelite.PageCacheOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L332">Definition</a></p>
<pre><code class="language-moonscript">{
  _page_size: number,
  _main_file: ?writelite.File, -- Lazy
}
</code></pre>
<h2 id="writelitepageopts"><a class="header" href="#writelitepageopts"><code>writelite.PageOpts</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L1010">Definition</a></p>
<pre><code class="language-moonscript">{
  offset: number,
  content: string,
}
</code></pre>
<h2 id="writelitetransaction"><a class="header" href="#writelitetransaction"><code>writelite.Transaction</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L421">Definition</a></p>
<pre><code class="language-moonscript">{
  read: ("*a"|number) =&gt; &lt;?string, ?string&gt;,
  write: (string) =&gt; &lt;&gt;,
  seek: (Whence, ?number) =&gt; &lt;?number, ?string&gt;,
  abort: () =&gt; &lt;&gt;,
}
</code></pre>
<h2 id="writelitewritelite"><a class="header" href="#writelitewritelite"><code>writelite.Writelite</code></a></h2>
<p><a href="https://github.com/TheSignPainter98/shunt/blob/master/shunt/writelite.yue#L49">Definition</a></p>
<pre><code class="language-moonscript">{
  mode: (writelite.Mode) =&gt; Self,
  page_size: (number) =&gt; Self,
  open: () =&gt; &lt;boolean, ?string&gt;,
  transaction: ((writelite.Transaction) -&gt; &lt;&gt;) =&gt; &lt;&gt;,
  close: () =&gt; &lt;boolean, ?string&gt;,
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="explanations"><a class="header" href="#explanations">Explanations</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/js/mermaid.min.js"></script>
        <script src="theme/js/mermaid-init.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
